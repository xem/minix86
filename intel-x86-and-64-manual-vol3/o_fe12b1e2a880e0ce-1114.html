<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1114</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:8px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1114-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1114.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">26-22&#160;Vol. 3C</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">VM&#160;ENTRIES</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft02">‚Äî&#160;If&#160;the VM&#160;entry was&#160;executed&#160;in SMM,&#160;SMIs&#160;are blocked&#160;after VM&#160;entry if and&#160;only&#160;if the&#160;bit&#160;2&#160;in&#160;the inter-</p>
<p style="position:absolute;top:117px;left:119px;white-space:nowrap" class="ft02">ruptibility-state&#160;field&#160;is 1.</p>
<p style="position:absolute;top:167px;left:68px;white-space:nowrap" class="ft03">26.6.2 Activity&#160;</p>
<p style="position:absolute;top:167px;left:216px;white-space:nowrap" class="ft03">State</p>
<p style="position:absolute;top:198px;left:68px;white-space:nowrap" class="ft09">The&#160;activity-state field in&#160;the guest-state&#160;area controls&#160;whether,&#160;after&#160;VM&#160;entry,&#160;the logical processor is&#160;active&#160;or in&#160;<br/>one of the&#160;inactive&#160;states&#160;identified&#160;in&#160;<a href="o_fe12b1e2a880e0ce-1051.html">Section&#160;24.4.2. The us</a>e&#160;of&#160;this field is&#160;determined as&#160;follows:</p>
<p style="position:absolute;top:236px;left:68px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:237px;left:93px;white-space:nowrap" class="ft09">If the VM&#160;entry&#160;is vectoring, the&#160;logical processor is&#160;in the&#160;active&#160;state&#160;after VM&#160;entry.&#160;While the consistency&#160;<br/>checks described in<a href="o_fe12b1e2a880e0ce-1104.html">&#160;Section&#160;26.3.1.5&#160;</a>on the&#160;activity-state&#160;field&#160;do apply in&#160;this&#160;case, the&#160;contents of the&#160;<br/>activity-state field do&#160;not determine the&#160;activity state after&#160;VM&#160;entry.</p>
<p style="position:absolute;top:292px;left:68px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:292px;left:93px;white-space:nowrap" class="ft09">If the VM&#160;entry&#160;is not vectoring, the&#160;logical processor ends VM&#160;entry in the&#160;activity&#160;state&#160;specified in&#160;the guest-<br/>state area. If&#160;VM&#160;entry ends with&#160;the logical processor in an&#160;inactive activity&#160;state, the VM&#160;entry generates any&#160;<br/>special bus cycle that&#160;is normally&#160;generated when&#160;that&#160;activity&#160;state is&#160;entered from the&#160;active&#160;state. If&#160;<br/>VM&#160;entry would&#160;end with the&#160;logical&#160;processor&#160;in the&#160;shutdown state and&#160;the logical processor is&#160;in SMX&#160;<br/>operation,</p>
<p style="position:absolute;top:356px;left:162px;white-space:nowrap" class="ft05">1</p>
<p style="position:absolute;top:358px;left:169px;white-space:nowrap" class="ft02">&#160;an Intel</p>
<p style="position:absolute;top:356px;left:225px;white-space:nowrap" class="ft05">¬Æ</p>
<p style="position:absolute;top:358px;left:236px;white-space:nowrap" class="ft02">&#160;TXT&#160;shutdown&#160;condition occurs.&#160;The&#160;error code used is&#160;0000H, indicating ‚Äúlegacy&#160;</p>
<p style="position:absolute;top:375px;left:93px;white-space:nowrap" class="ft02">shutdown.‚Äù&#160;See&#160;<i>Intel</i></p>
<p style="position:absolute;top:372px;left:234px;white-space:nowrap" class="ft07"><i>¬Æ</i></p>
<p style="position:absolute;top:375px;left:244px;white-space:nowrap" class="ft06"><i>&#160;Trusted Execution Technology&#160;Preliminary&#160;Architecture&#160;Specification</i>.</p>
<p style="position:absolute;top:397px;left:68px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:397px;left:93px;white-space:nowrap" class="ft010">Some&#160;activity&#160;states unconditionally&#160;block certain&#160;events. The&#160;following&#160;blocking is&#160;in effect after&#160;any VM&#160;entry&#160;<br/>that puts&#160;the processor in&#160;the indicated&#160;state:<br/>‚Äî&#160;The active&#160;state blocks start-up IPIs (SIPIs). SIPIs that&#160;arrive while a logical processor is in&#160;the&#160;active state&#160;</p>
<p style="position:absolute;top:454px;left:119px;white-space:nowrap" class="ft02">and in VMX non-root operation are discarded&#160;and do not cause VM&#160;exits.</p>
<p style="position:absolute;top:478px;left:93px;white-space:nowrap" class="ft02">‚Äî&#160;The&#160;HLT state blocks start-up&#160;IPIs&#160;(SIPIs). SIPIs that&#160;arrive&#160;while a logical processor is in the HLT state and&#160;</p>
<p style="position:absolute;top:495px;left:119px;white-space:nowrap" class="ft02">in VMX non-root operation are&#160;discarded&#160;and do&#160;not cause&#160;VM&#160;exits.</p>
<p style="position:absolute;top:519px;left:93px;white-space:nowrap" class="ft02">‚Äî&#160;The shutdown state&#160;blocks external interrupts&#160;and SIPIs. External interrupts that arrive while&#160;a logical&#160;</p>
<p style="position:absolute;top:535px;left:119px;white-space:nowrap" class="ft09">processor is&#160;in the&#160;shutdown&#160;state&#160;and in VMX non-root operation do not cause&#160;VM&#160;exits&#160;even if the&#160;<br/>‚Äúexternal-interrupt&#160;exiting‚Äù VM-execution control&#160;is 1.&#160;SIPIs that&#160;arrive&#160;while&#160;a logical processor is&#160;in the&#160;<br/>shutdown&#160;state&#160;and in&#160;VMX non-root operation&#160;are discarded&#160;and&#160;do not&#160;cause VM&#160;exits.</p>
<p style="position:absolute;top:592px;left:93px;white-space:nowrap" class="ft02">‚Äî&#160;The wait-for-SIPI&#160;state blocks&#160;external interrupts,&#160;non-maskable interrupts (NMIs),&#160;INIT&#160;signals,&#160;and&#160;</p>
<p style="position:absolute;top:609px;left:119px;white-space:nowrap" class="ft09">system-management interrupts (SMIs). Such&#160;events&#160;do&#160;not cause&#160;VM&#160;exits&#160;if they arrive while&#160;a logical&#160;<br/>processor is&#160;in the&#160;wait-for-SIPI state and in VMX non-root operation do&#160;not cause&#160;VM&#160;exits&#160;regardless&#160;of&#160;<br/>the&#160;settings of the&#160;pin-based VM-execution&#160;controls.</p>
<p style="position:absolute;top:692px;left:68px;white-space:nowrap" class="ft03">26.6.3&#160;</p>
<p style="position:absolute;top:692px;left:148px;white-space:nowrap" class="ft03">Delivery of&#160;Pending Debug Exceptions after VM&#160;Entry</p>
<p style="position:absolute;top:723px;left:68px;white-space:nowrap" class="ft010">The pending&#160;debug exceptions field&#160;in&#160;the guest-state&#160;area&#160;indicates whether&#160;there are&#160;debug&#160;exceptions that&#160;have&#160;<br/>not&#160;yet&#160;been&#160;deliver<a href="o_fe12b1e2a880e0ce-1051.html">ed (see Section 24.4.2). This se</a>ction&#160;describes how these are&#160;treated on VM&#160;entry.<br/>There are no pending&#160;debug exceptions&#160;after&#160;VM&#160;entry if&#160;any of the&#160;following&#160;are true:</p>
<p style="position:absolute;top:785px;left:68px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:786px;left:93px;white-space:nowrap" class="ft09">The&#160;VM&#160;entry&#160;is vectoring with one&#160;of&#160;the following interruption&#160;types: external&#160;interrupt, non-maskable&#160;<br/>interrupt&#160;(NMI), hardware exception,&#160;or privileged&#160;software&#160;exception.</p>
<p style="position:absolute;top:824px;left:68px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:825px;left:93px;white-space:nowrap" class="ft09">The&#160;interruptibility-state&#160;field does not&#160;indicate&#160;blocking&#160;by&#160;MOV&#160;SS&#160;and the&#160;VM&#160;entry&#160;is vectoring with either&#160;<br/>of the&#160;following&#160;interruption type: software&#160;interrupt or&#160;software exception.</p>
<p style="position:absolute;top:863px;left:68px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:864px;left:93px;white-space:nowrap" class="ft02">The VM&#160;entry&#160;is not&#160;vectoring&#160;and the&#160;activity-state&#160;field indicates&#160;either shutdown or wait-for-SIPI.</p>
<p style="position:absolute;top:888px;left:68px;white-space:nowrap" class="ft09">If none of&#160;the&#160;above hold,&#160;the&#160;pending debug&#160;exceptions&#160;field&#160;specifies&#160;the&#160;debug&#160;exceptions that are&#160;pending&#160;for&#160;<br/>the guest.&#160;There&#160;are&#160;<b>valid&#160;pending debug exceptions</b>&#160;if&#160;either the&#160;BS&#160;bit (bit&#160;14)&#160;or&#160;the enable-breakpoint&#160;bit&#160;<br/>(bit&#160;12) is&#160;1.&#160;If there&#160;are&#160;valid pending&#160;debug exceptions, they are&#160;handled as&#160;follows:</p>
<p style="position:absolute;top:943px;left:68px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:943px;left:93px;white-space:nowrap" class="ft010">If the VM&#160;entry&#160;is not&#160;vectoring, the&#160;pending&#160;debug&#160;exceptions are&#160;treated&#160;as&#160;they would&#160;had&#160;they been&#160;<br/>encountered&#160;normally&#160;in guest execution:<br/>‚Äî&#160;If&#160;the logical processor is&#160;not&#160;blocking such&#160;exceptions (the&#160;interruptibility-state&#160;field&#160;indicates no blocking&#160;</p>
<p style="position:absolute;top:1000px;left:119px;white-space:nowrap" class="ft02">by MOV&#160;SS),&#160;a debug&#160;exception is&#160;delivered&#160;after&#160;VM&#160;entry (see below).&#160;</p>
<p style="position:absolute;top:1038px;left:68px;white-space:nowrap" class="ft02">1.&#160;A logical processor is&#160;in&#160;SMX operation&#160;if&#160;GETSEC[SEXIT] has not been&#160;executed&#160;since&#160;the last&#160;execution of&#160;GETSEC[SENTER]. See&#160;</p>
<p style="position:absolute;top:1054px;left:89px;white-space:nowrap" class="ft02">Chapter 6,&#160;‚ÄúSafer&#160;Mode&#160;Extensions Reference,<a href="˛ˇ">‚Äù in&#160;<i>Intel¬Æ 64 and IA-32 Architectures Software&#160;Developer‚Äôs Manual, Volume 2B</i>.</a></p>
</div>
</body>
</html>
